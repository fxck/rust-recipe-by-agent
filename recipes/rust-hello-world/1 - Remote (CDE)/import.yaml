project:
  name: rust-hello-world-remote-cde

services:
  # Remote development container — mount this via SSHFS or your IDE's remote
  # extension (VS Code Remote-SSH, JetBrains Gateway) to edit files as if they
  # were local. Receives 'dev' setup deployments: full Rust source code +
  # pre-fetched crate registry, so 'cargo run' is available immediately after
  # SSH login without any extra setup.
  # Increase minRam to 4 GiB (commented below) for comfortable multi-file
  # development with rust-analyzer and cargo build running concurrently.
  - hostname: appdev
    type: rust@stable
    zeropsSetup: dev
    buildFromGit: https://github.com/zerops-recipe-apps/rust-hello-world-app
    enableSubdomainAccess: true
    minContainers: 1
    maxContainers: 1
    resources:
      minRam: 0.5
      # minRam: 4  # Recommended for comfortable interactive Rust development
      minVCpu: 1

  # Staging container that mirrors the production build pipeline.
  # Push code from appdev → release binary compiled → deployed here →
  # readiness check confirms health before traffic is routed.
  - hostname: appstage
    type: rust@stable
    zeropsSetup: prod
    buildFromGit: https://github.com/zerops-recipe-apps/rust-hello-world-app
    enableSubdomainAccess: true
    minContainers: 1
    maxContainers: 1
    resources:
      minRam: 0.125
      minFreeRamGB: 0.05

  # Deploy PostgreSQL database for app data.
  # Priority 10 ensures the database starts before app containers, preventing
  # connection errors during deployment. This startup ordering pattern applies
  # to all data services in this project.
  - hostname: db
    type: postgresql@17
    mode: NON_HA
    priority: 10
