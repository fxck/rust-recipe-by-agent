project:
  name: rust-hello-world-stage

services:
  # Deploy PostgreSQL database for staging environment.
  # Priority 10 ensures database starts before app â€” pattern explained in Env 0.
  - hostname: db
    type: postgresql@17
    mode: NON_HA
    priority: 10

  # Deploy staging app for pre-production testing.
  # Uses same prod setup as production but runs on single container with minimal resources.
  # Teams test features here before promoting to production (Env 4-5).
  - hostname: app
    type: rust@stable
    zeropsSetup: prod
    buildFromGit: https://github.com/zerops-recipe-apps/rust-hello-world-app
    enableSubdomainAccess: true
    verticalAutoscaling:
      minRam: 0.25
      # Reserve 40% RAM for traffic spikes.
      # Rust's efficient GC needs less headroom than Node.js/Python but still requires buffer.
      minFreeRamGB: 0.1
