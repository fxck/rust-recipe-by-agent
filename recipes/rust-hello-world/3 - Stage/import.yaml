project:
  name: rust-hello-world-stage

services:
  # Staging app: runs the same production build pipeline as production
  # (release binary compiled from source, readiness check before traffic).
  # Single container at minimal resources â€” staging exists to catch build
  # and integration issues before they reach production, not to handle load.
  - hostname: app
    type: rust@stable
    zeropsSetup: prod
    buildFromGit: https://github.com/zerops-recipe-apps/rust-hello-world-app
    enableSubdomainAccess: true
    minContainers: 1
    maxContainers: 1
    resources:
      minRam: 0.125
      minFreeRamGB: 0.05

  # Deploy PostgreSQL database for app data.
  # Priority 10 ensures the database starts before the app container,
  # preventing connection errors during deployment.
  - hostname: db
    type: postgresql@17
    mode: NON_HA
    priority: 10
